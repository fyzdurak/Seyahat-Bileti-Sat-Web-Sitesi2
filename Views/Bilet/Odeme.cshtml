<!-- Views\Bilet\Odeme.cshtml -->
@{
    @model BiletSatisWebApp.Models.ViewModel.OdemeVM
}

<h2 class="text-center mt-4 display-4 text-primary">Ödeme İşlemi</h2>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h4 class="text-primary">Sefer Bilgileri</h4>
            <p>
                Sefer: @Model.trip.FromCity → @Model.trip.ToCity<br />
                Saat: @Model.trip.DepartureTime
            </p>
            <p>
                Seçilen Koltuklar (@(Model.SeatSelection.SelectedSeats.Count()) adet koltuk):
            </p>
            <ul class="list-group">
                @foreach (var item in Model.SeatSelection.SelectedSeats)
                {
                    <li class="list-group-item">
                        Koltuk @item (@Model.trip.Price ₺)
                        <input type="text" class="form-control mt-1" placeholder="Yolcu Ad Soyad giriniz." />
                    </li>
                }
            </ul>
            <p class="mt-3">Ödenecek Tutar: @Model.OdemeTutari ₺</p>
        </div>
        <div class="col-md-6">
            <h4 class="text-primary">Ödeme Bilgileri</h4>
            <form id="paymentForm">
                <div class="mb-3">
                    <label for="name" class="form-label">Kart Üzerindeki İsim</label>
                    <input type="text" class="form-control" id="name" placeholder="Ad Soyad" required>
                </div>

                <div class="mb-3">
                    <label for="number" class="form-label">Kart Numarası</label>
                    <input type="text" class="form-control" id="number" placeholder="0000 0000 0000 0000" required pattern="\d{4} \d{4} \d{4} \d{4}">
                </div>

                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label for="month" class="form-label">Ay</label>
                        <select id="month" class="form-select" required>
                            <option value="" disabled selected>Ay</option>
                            <option value="01">01</option>
                            <option value="02">02</option>
                            <option value="03">03</option>
                            <option value="04">04</option>
                            <option value="05">05</option>
                            <option value="06">06</option>
                            <option value="07">07</option>
                            <option value="08">08</option>
                            <option value="09">09</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="year" class="form-label">Yıl</label>
                        <select id="year" class="form-select" required>
                            <option value="" disabled selected>Yıl</option>
                            <option value="2025">2025</option>
                            <option value="2026">2026</option>
                            <option value="2027">2027</option>
                            <option value="2028">2028</option>
                            <option value="2029">2029</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="cvv" class="form-label">CVV</label>
                        <input type="text" class="form-control" id="cvv" maxlength="3" placeholder="***" required pattern="\d{3}">
                    </div>
                </div>

                <div class="mb-3">
                    <label for="installment" class="form-label">Taksit</label>
                    <select id="installment" class="form-select" required>
                        <option value="" disabled selected>Taksit Seçiniz</option>
                        <option value="1">Tek Çekim</option>
                        <option value="3">3 Taksit</option>
                        <option value="6">6 Taksit</option>
                        <option value="9">9 Taksit</option>
                    </select>
                </div>

                <button type="submit" class="btn btn-primary w-100">Ödemeye Devam Et</button>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    document.getElementById('paymentForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const name = document.getElementById('name').value;
        const number = document.getElementById('number').value;
        const month = document.getElementById('month').value;
        const year = document.getElementById('year').value;
        const cvv = document.getElementById('cvv').value;
        const installment = document.getElementById('installment').value;

        if (!name || !number || !month || !year || !cvv || !installment) {
            Swal.fire({
                icon: 'error',
                title: 'Hata!',
                text: 'Lütfen tüm ödeme bilgilerini doldurun.'
            });
            return;
        }

        // Simulate payment processing
        Swal.fire({
            icon: 'success',
            title: 'Ödeme Başarılı!',
            text: 'Ödeme işleminiz başarıyla gerçekleştirilmiştir. İyi yolculuklar dileriz!'
        }).then(() => {
            window.location.href = '/' // Redirect to homepage or another page
        });
    });
</script>
