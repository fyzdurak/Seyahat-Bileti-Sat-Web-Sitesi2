@{
    ViewData["Title"] = "Tren Bileti Satış";
}

<div class="container mt-5">
    <h2 class="mb-4 display-4 text-primary">Tren Bileti Ara</h2>

    <form method="post" asp-action="Tren" asp-controller="Bilet">
        <div class="row g-3">

            <!-- Nereden -->
            <select id="nereden" name="Nereden" class="form-select" required>
                <option value="" selected disabled>Şehir seçiniz</option>
                @foreach (var city in ViewBag.Cities)
                {
                    <option value="@city">@city</option>
                }
            </select>

            <!-- Nereye -->
            <select id="nereye" name="Nereye" class="form-select" required>
                <option value="" selected disabled>Şehir seçiniz</option>
                @foreach (var city in ViewBag.Cities)
                {
                    <option value="@city">@city</option>
                }
            </select>

            <!-- Gidiş Tarihi -->
            <div class="col-md-6">
                <label for="gidisTarihi" class="form-label">Gidiş Tarihi</label>
                <input type="date" id="gidisTarihi" name="GidisTarihi" class="form-control" required />
            </div>

            <!-- Yolculuk Türü -->
            <div class="col-md-6">
                <label class="form-label d-block">Yolculuk Türü</label>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="YolculukTuru" id="tekGidis" value="TekGidis" checked>
                    <label class="form-check-label" for="tekGidis">Tek Gidiş</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="YolculukTuru" id="gidisDonus" value="GidisDonus">
                    <label class="form-check-label" for="gidisDonus">Gidiş-Dönüş</label>
                </div>
            </div>

            <!-- Dönüş Tarihi -->
            <div class="col-md-6" id="donusTarihiDiv" style="display:none;">
                <label for="donusTarihi" class="form-label">Dönüş Tarihi</label>
                <input type="date" id="donusTarihi" name="DonusTarihi" class="form-control" />
            </div>

            <!-- Ara Butonu -->
            <div class="col-12 text-center mt-3 my-5">
                <button type="submit" class="btn btn-primary px-5">Ara</button>
            </div>

        </div>
    </form>
</div>

@section Scripts {
    <script>

        document.getElementById('gidisTarihi').addEventListener('click', function() {
            document.getElementById('gidisTarihi').showPicker(); // Modern tarayıcılarda çalışır
        });

        document.getElementById('donusTarihi').addEventListener('click', function() {
            document.getElementById('donusTarihi').showPicker(); // Modern tarayıcılarda çalışır
        });
        // Bugünün tarihi min olarak ayarla
        const today = new Date().toISOString().split('T')[0];
        document.getElementById("gidisTarihi").setAttribute("min", today);
        document.getElementById("donusTarihi").setAttribute("min", today);

        // Gidiş tarihi seçildiğinde dönüş min değeri güncellenir
        document.getElementById("gidisTarihi").addEventListener("change", function () {
            const gidis = this.value;
            const donus = document.getElementById("donusTarihi");
            donus.min = gidis;
        });

        // Gidiş-dönüş seçildiğinde dönüş tarihi alanı açılır
        document.addEventListener("DOMContentLoaded", function () {
            const tekGidisRadio = document.getElementById("tekGidis");
            const gidisDonusRadio = document.getElementById("gidisDonus");
            const donusTarihiDiv = document.getElementById("donusTarihiDiv");
            const donusTarihiInput = document.getElementById("donusTarihi");

            function toggleDonusTarihi() {
                if (gidisDonusRadio.checked) {
                    donusTarihiDiv.style.display = "block";
                    donusTarihiInput.required = true;
                } else {
                    donusTarihiDiv.style.display = "none";
                    donusTarihiInput.required = false;
                    donusTarihiInput.value = "";
                }
            }

            tekGidisRadio.addEventListener("change", toggleDonusTarihi);
            gidisDonusRadio.addEventListener("change", toggleDonusTarihi);

            toggleDonusTarihi();
        });
    </script>
}
